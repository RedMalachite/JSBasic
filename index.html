<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Widget</title>
</head>
<body>
<label for="cityInput">Enter city name:</label>
<input type="text" id="cityInput">
<button onclick="getWeather()">Get Weather</button>

<div id="weatherSection"></div>

<script>
    async function getWeather() {
        const apiKey = '80ef50b309a6427e5f1ab29cce1ca7ee';
        const cityInput = document.getElementById('cityInput').value;
        const weatherSection = document.getElementById('weatherSection');

        try {
            // Step 1: Get city coordinates
            const coordinates = await getCityCoordinates(apiKey, cityInput);

            // Step 2: Get weather data using coordinates
            const weatherData = await getWeatherData(apiKey, coordinates);

            // Display weather information
            displayWeather(weatherData, weatherSection);
        } catch (error) {
            console.error('Error:', error);
            weatherSection.innerHTML = 'Error fetching weather data.';
        }
    }

    async function getCityCoordinates(apiKey, cityName) {
        const geocodingUrl = `https://api.openweathermap.org/geo/1.0/direct?q=${cityName}&limit=1&appid=${apiKey}`;
        const response = await fetch(geocodingUrl);
        const data = await response.json();

        if (data.length === 0) {
            throw new Error('City not found');
        }

        const coordinates = {
            lat: data[0].lat,
            lon: data[0].lon
        };

        return coordinates;
    }

    async function getWeatherData(apiKey, coordinates) {
        const weatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${coordinates.lat}&lon=${coordinates.lon}&appid=${apiKey}`;
        const response = await fetch(weatherUrl);
        const data = await response.json();

        if (data.cod !== 200) {
            throw new Error(`Error: ${data.message}`);
        }

        return data;
    }

    function displayWeather(weatherData, weatherSection) {
        const weatherHtml = `
        <h2>${weatherData.name}, ${weatherData.sys.country}</h2>
        <p>Temperature: ${weatherData.main.temp} &deg;C</p>
        <p>Weather: ${weatherData.weather[0].description}</p>
        <p>Humidity: ${weatherData.main.humidity}%</p>
        <p>Wind Speed: ${weatherData.wind.speed} m/s</p>
        <p>Pressure: ${weatherData.main.pressure} hPa</p>
      `;

        weatherSection.innerHTML = weatherHtml;
    }
</script>
</body>
</html>
